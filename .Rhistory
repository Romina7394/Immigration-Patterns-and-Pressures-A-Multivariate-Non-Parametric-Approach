# ?? Libraries
library(readxl)
library(ggplot2)
library(dplyr)
# ?? Load Excel data
df <- read_excel("Data base Immigration.xlsx")
# ✅ Rename relevant columns
df <- df %>%
  rename(
    BrainDrain = `E3: Human Flight and Brain Drain`,
    EconInequality = `E2: Economic Inequality`,
    DemographicPressures = `S1: Demographic Pressures`,
    PublicServices = `P2: Public Services`,
    HumanRights = `P3: Human Rights`,
    ExtIntervention = `X1: External Intervention`
  )
# دسته‌بندی گروه‌ها:
df$PublicGroup <- cut(df$PublicServices, breaks=3, labels=c("Low", "Medium", "High"))
df$InterventionGroup <- ifelse(df$ExtIntervention < median(df$ExtIntervention, na.rm=TRUE), "Low", "High")
# ✅ 1. Spearman Correlation: Economic Inequality vs Brain Drain
cat("\n----- Test 1: Economic Inequality vs Brain Drain -----\n")
cat("H0: There is no monotonic relationship between Economic Inequality and Brain Drain\n")
cat("H1: There is a monotonic relationship\n")
test1 <- cor.test(df$EconInequality, df$BrainDrain, method = "spearman", use = "complete.obs")
print(test1)
# ✅ 2. Spearman Correlation: Demographic Pressures vs Brain Drain
cat("\n----- Test 2: Demographic Pressures vs Brain Drain -----\n")
cat("H0: There is no monotonic relationship between Demographic Pressures and Brain Drain\n")
cat("H1: There is a monotonic relationship\n")
test2 <- cor.test(df$DemographicPressures, df$BrainDrain, method = "spearman", use = "complete.obs")
print(test2)
# ✅ 3. Kruskal-Wallis Test: Public Services vs Brain Drain
cat("\n----- Test 3: Public Services vs Brain Drain -----\n")
cat("H0: All Public Services groups have equal distribution of Brain Drain\n")
cat("H1: At least one group differs\n")
df$PublicGroup <- cut(df$PublicServices, breaks=3, labels=c("Low", "Medium", "High"))
test3 <- kruskal.test(BrainDrain ~ PublicGroup, data=df)
print(test3)
# ✅ 4. Wilcoxon Test: External Intervention (Low vs High) vs Brain Drain
cat("\n----- Test 4: External Intervention vs Brain Drain -----\n")
cat("H0: Brain Drain distributions are the same for Low and High Intervention\n")
cat("H1: Distributions are different\n")
df$InterventionGroup <- ifelse(df$ExtIntervention < median(df$ExtIntervention, na.rm=TRUE), "Low", "High")
test4 <- wilcox.test(BrainDrain ~ InterventionGroup, data=df)
print(test4)
# ✅ 5. Spearman Correlation: Human Rights vs Brain Drain
cat("\n----- Test 5: Human Rights vs Brain Drain -----\n")
cat("H0: No monotonic relationship between Human Rights and Brain Drain\n")
cat("H1: Monotonic relationship exists\n")
test5 <- cor.test(df$HumanRights, df$BrainDrain, method = "spearman", use = "complete.obs")
print(test5)
ggplot(df, aes(x = EconInequality, y = BrainDrain)) +
  geom_point(color = "steelblue") +
  geom_smooth(method = "lm", se = FALSE, color = "darkred") +
  labs(title = "Economic Inequality vs Brain Drain",
       subtitle = "Spearman Correlation: rho = 0.55, p < 0.001",
       x = "Economic Inequality",
       y = "Brain Drain") +
  theme_minimal()
ggplot(df, aes(x = DemographicPressures, y = BrainDrain)) +
  geom_point(color = "darkgreen") +
  geom_smooth(method = "lm", se = FALSE, color = "orange") +
  labs(title = "Demographic Pressures vs Brain Drain",
       subtitle = "Spearman Correlation: rho = 0.60, p < 0.001",
       x = "Demographic Pressures",
       y = "Brain Drain") +
  theme_minimal()
ggplot(df, aes(x = PublicGroup, y = BrainDrain, fill = PublicGroup)) +
  geom_boxplot() +
  labs(title = "Public Services Groups vs Brain Drain",
       subtitle = "Kruskal-Wallis Test: p < 0.001",
       x = "Public Services Group",
       y = "Brain Drain") +
  theme_minimal()
ggplot(df, aes(x = InterventionGroup, y = BrainDrain, fill = InterventionGroup)) +
  geom_boxplot() +
  labs(title = "External Intervention vs Brain Drain",
       subtitle = "Wilcoxon Test: p < 0.001",
       x = "Intervention Group",
       y = "Brain Drain") +
  theme_minimal()
ggplot(df, aes(x = HumanRights, y = BrainDrain)) +
  geom_point(color = "purple") +
  geom_smooth(method = "lm", se = FALSE, color = "darkorange") +
  labs(title = "Human Rights vs Brain Drain",
       subtitle = "Spearman Correlation: rho = 0.36, p < 0.001",
       x = "Human Rights",
       y = "Brain Drain") +
  theme_minimal()
